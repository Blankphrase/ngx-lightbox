/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { NgxHotkeysService } from '../ngx-hotkeys.service';
var NgxCheatsheetComponent = /** @class */ (function () {
    function NgxCheatsheetComponent(hotkeysService) {
        this.hotkeysService = hotkeysService;
        this.helpVisible = false;
        this._map = {
            command: '\u2318',
            // ⌘
            shift: '\u21E7',
            // ⇧
            left: '\u2190',
            // ←
            right: '\u2192',
            // →
            up: '\u2191',
            // ↑
            down: '\u2193',
            // ↓
            'return': '\u23CE',
            // ⏎
            backspace: '\u232B' // ⌫
        };
        this.title = this.hotkeysService.options.cheatSheetTitle;
    }
    /**
     * @return {?}
     */
    NgxCheatsheetComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this._subscription = this.hotkeysService.cheatSheetToggled
            .subscribe(function (isOpen) {
            if (isOpen !== false) {
                _this.hotkeys = _this.hotkeysService.hotkeys
                    .filter(function (hotkey) { return hotkey.description; });
            }
            if (isOpen === false) {
                _this.helpVisible = false;
            }
            else {
                _this.toggleCheatSheet();
            }
        });
    };
    /**
     * @param {?} hotkey
     * @return {?}
     */
    NgxCheatsheetComponent.prototype.formatHotkey = /**
     * @param {?} hotkey
     * @return {?}
     */
    function (hotkey) {
        if (!hotkey.format) {
            var /** @type {?} */ combo = Array.isArray(hotkey.combo) ? hotkey.combo[0] : hotkey.combo;
            var /** @type {?} */ sequence = combo.split(/[\s]/);
            for (var /** @type {?} */ i = 0; i < sequence.length; i++) {
                sequence[i] = this.symbolize(sequence[i]);
            }
            hotkey.format = sequence;
        }
        return hotkey.format;
    };
    /**
     * @param {?} combo
     * @return {?}
     */
    NgxCheatsheetComponent.prototype.symbolize = /**
     * @param {?} combo
     * @return {?}
     */
    function (combo) {
        var /** @type {?} */ comboSplit = combo.split('+');
        for (var /** @type {?} */ i = 0; i < comboSplit.length; i++) {
            // try to resolve command / ctrl based on OS:
            if (comboSplit[i] === 'mod') {
                if (window.navigator && window.navigator.platform.indexOf('Mac') >= 0) {
                    comboSplit[i] = 'command';
                }
                else {
                    comboSplit[i] = 'ctrl';
                }
            }
            comboSplit[i] = this._map[comboSplit[i]] || comboSplit[i];
        }
        return comboSplit.join(' + ');
    };
    /**
     * @return {?}
     */
    NgxCheatsheetComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this._subscription) {
            this._subscription.unsubscribe();
        }
    };
    /**
     * @return {?}
     */
    NgxCheatsheetComponent.prototype.toggleCheatSheet = /**
     * @return {?}
     */
    function () {
        this.helpVisible = !this.helpVisible;
    };
    NgxCheatsheetComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-cheatsheet',
                    template: "<div class=\"ngx-cheatsheet fade\" [ngClass]=\"{'in': helpVisible}\" style=\"display:none\">\n  <div class=\"ngx-cheatsheet__hotkeys\">\n    <h4 class=\"ngx-cheatsheet__hotkeys__title\">{{ title }}</h4>\n    <table>\n      <tbody>\n      <tr *ngFor=\"let hotkey of hotkeys\">\n        <td class=\"ngx-cheatsheet__hotkeys__keys\">\n          <span class=\"ngx-cheatsheet__hotkeys__keys__key\">{{ formatHotkey(hotkey) }}</span>\n        </td>\n        <td class=\"ngx-cheatsheet__hotkeys__keys__text\">{{ hotkey.description }}</td>\n      </tr>\n      </tbody>\n    </table>\n    <div class=\"ngx-cheatsheet__hotkeys__close\" (click)=\"toggleCheatSheet()\">&#215;</div>\n  </div>\n</div>\n",
                    styles: [".ngx-cheatsheet{display:table!important;position:fixed;width:100%;height:100%;top:0;left:0;color:#333;font-size:1em;background-color:rgba(255,255,255,.9)}.ngx-cheatsheet.fade{z-index:-1024;visibility:hidden;opacity:0;transition:opacity .15s linear}.ngx-cheatsheet.fade.in{z-index:10002;visibility:visible;opacity:1}.ngx-cheatsheet__hotkeys{width:100%;height:100%;display:table-cell;vertical-align:middle}.ngx-cheatsheet__hotkeys__title{font-weight:700;text-align:center;font-size:1.2em}.ngx-cheatsheet__hotkeys table{margin:auto;color:#333}.ngx-cheatsheet__hotkeys__keys{padding:5px;text-align:right}.ngx-cheatsheet__hotkeys__keys__key{display:inline-block;color:#fff;background-color:#333;border:1px solid #333;border-radius:5px;text-align:center;margin-right:5px;box-shadow:inset 0 1px 0 #666,0 1px 0 #bbb;padding:5px 9px;font-size:1em}.ngx-cheatsheet__hotkeys__keys__text{padding-left:10px;font-size:1em}.ngx-cheatsheet__hotkeys__close{position:fixed;top:20px;right:20px;font-size:2em;font-weight:700;padding:5px 10px;border:1px solid #ddd;border-radius:5px;min-height:45px;min-width:45px;text-align:center}@media all and (max-width:500px){.ngx-cheatsheet__hotkeys{font-size:.8em}}@media all and (min-width:750px){.ngx-cheatsheet__hotkeys{font-size:1.2em}}"]
                },] },
    ];
    /** @nocollapse */
    NgxCheatsheetComponent.ctorParameters = function () { return [
        { type: NgxHotkeysService, },
    ]; };
    NgxCheatsheetComponent.propDecorators = {
        "title": [{ type: Input },],
    };
    return NgxCheatsheetComponent;
}());
export { NgxCheatsheetComponent };
function NgxCheatsheetComponent_tsickle_Closure_declarations() {
    /** @type {!Array<{type: !Function, args: (undefined|!Array<?>)}>} */
    NgxCheatsheetComponent.decorators;
    /**
     * @nocollapse
     * @type {function(): !Array<(null|{type: ?, decorators: (undefined|!Array<{type: !Function, args: (undefined|!Array<?>)}>)})>}
     */
    NgxCheatsheetComponent.ctorParameters;
    /** @type {!Object<string,!Array<{type: !Function, args: (undefined|!Array<?>)}>>} */
    NgxCheatsheetComponent.propDecorators;
    /** @type {?} */
    NgxCheatsheetComponent.prototype.title;
    /** @type {?} */
    NgxCheatsheetComponent.prototype.helpVisible;
    /** @type {?} */
    NgxCheatsheetComponent.prototype.hotkeys;
    /** @type {?} */
    NgxCheatsheetComponent.prototype._subscription;
    /** @type {?} */
    NgxCheatsheetComponent.prototype._map;
    /** @type {?} */
    NgxCheatsheetComponent.prototype.hotkeysService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWNoZWF0c2hlZXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGJhbHRpY2NvZGUvbmd4LWhvdGtleXMvIiwic291cmNlcyI6WyJsaWIvbmd4LWNoZWF0c2hlZXQvbmd4LWNoZWF0c2hlZXQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLEtBQUssRUFBb0IsTUFBTSxlQUFlLENBQUM7QUFHbEUsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sd0JBQXdCLENBQUM7O0lBNkN2RCxnQ0FBb0IsY0FBaUM7UUFBakMsbUJBQWMsR0FBZCxjQUFjLENBQW1COzJCQWhCdkMsS0FBSztvQkFLQztZQUNsQixPQUFPLEVBQUUsUUFBUTs7WUFDakIsS0FBSyxFQUFFLFFBQVE7O1lBQ2YsSUFBSSxFQUFFLFFBQVE7O1lBQ2QsS0FBSyxFQUFFLFFBQVE7O1lBQ2YsRUFBRSxFQUFFLFFBQVE7O1lBQ1osSUFBSSxFQUFFLFFBQVE7O1lBQ2QsUUFBUSxFQUFFLFFBQVE7O1lBQ2xCLFNBQVMsRUFBRSxRQUFRO1NBQ3BCO1FBR0MsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUM7S0FDMUQ7Ozs7SUFFRCx5Q0FBUTs7O0lBQVI7UUFBQSxpQkFjQztRQWJDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxpQkFBaUI7YUFDdkQsU0FBUyxDQUFDLFVBQUMsTUFBTTtZQUNoQixFQUFFLENBQUMsQ0FBQyxNQUFNLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDckIsS0FBSSxDQUFDLE9BQU8sR0FBRyxLQUFJLENBQUMsY0FBYyxDQUFDLE9BQU87cUJBQ3ZDLE1BQU0sQ0FBQyxVQUFBLE1BQU0sSUFBSSxPQUFBLE1BQU0sQ0FBQyxXQUFXLEVBQWxCLENBQWtCLENBQUMsQ0FBQzthQUN6QztZQUVELEVBQUUsQ0FBQyxDQUFDLE1BQU0sS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUNyQixLQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQzthQUMxQjtZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNOLEtBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO2FBQ3pCO1NBQ0YsQ0FBQyxDQUFDO0tBQ047Ozs7O0lBRUQsNkNBQVk7Ozs7SUFBWixVQUFhLE1BQWU7UUFDMUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUNuQixxQkFBTSxLQUFLLEdBQVcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7WUFDbkYscUJBQU0sUUFBUSxHQUFhLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0MsR0FBRyxDQUFDLENBQUMscUJBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUN6QyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUMzQztZQUNELE1BQU0sQ0FBQyxNQUFNLEdBQUcsUUFBUSxDQUFDO1NBQzFCO1FBQ0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDdEI7Ozs7O0lBRU8sMENBQVM7Ozs7Y0FBQyxLQUFhO1FBQzdCLHFCQUFNLFVBQVUsR0FBYSxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzlDLEdBQUcsQ0FBQyxDQUFDLHFCQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQzs7WUFFM0MsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQzVCLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ3RFLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUM7aUJBQzNCO2dCQUFDLElBQUksQ0FBQyxDQUFDO29CQUNOLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUM7aUJBQ3hCO2FBQ0Y7WUFDRCxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDM0Q7UUFDRCxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzs7Ozs7SUFHaEMsNENBQVc7OztJQUFYO1FBQ0UsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7WUFDdkIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNsQztLQUNGOzs7O0lBRU0saURBQWdCOzs7O1FBQ3JCLElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDOzs7Z0JBakd4QyxTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLGdCQUFnQjtvQkFDMUIsUUFBUSxFQUFFLGlyQkFnQlg7b0JBQ0MsTUFBTSxFQUFFLENBQUMsNnVDQUE2dUMsQ0FBQztpQkFDeHZDOzs7O2dCQXZCTyxpQkFBaUI7OzswQkEwQnRCLEtBQUs7O2lDQTdCUjs7U0EyQmEsc0JBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1N1YnNjcmlwdGlvbn0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7Tmd4SG90a2V5c1NlcnZpY2V9IGZyb20gJy4uL25neC1ob3RrZXlzLnNlcnZpY2UnO1xuaW1wb3J0IHtJSG90a2V5fSBmcm9tICcuLi9pbnRlcmZhY2VzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWNoZWF0c2hlZXQnLFxuICB0ZW1wbGF0ZTogYDxkaXYgY2xhc3M9XCJuZ3gtY2hlYXRzaGVldCBmYWRlXCIgW25nQ2xhc3NdPVwieydpbic6IGhlbHBWaXNpYmxlfVwiIHN0eWxlPVwiZGlzcGxheTpub25lXCI+XG4gIDxkaXYgY2xhc3M9XCJuZ3gtY2hlYXRzaGVldF9faG90a2V5c1wiPlxuICAgIDxoNCBjbGFzcz1cIm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX190aXRsZVwiPnt7IHRpdGxlIH19PC9oND5cbiAgICA8dGFibGU+XG4gICAgICA8dGJvZHk+XG4gICAgICA8dHIgKm5nRm9yPVwibGV0IGhvdGtleSBvZiBob3RrZXlzXCI+XG4gICAgICAgIDx0ZCBjbGFzcz1cIm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19rZXlzXCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJuZ3gtY2hlYXRzaGVldF9faG90a2V5c19fa2V5c19fa2V5XCI+e3sgZm9ybWF0SG90a2V5KGhvdGtleSkgfX08L3NwYW4+XG4gICAgICAgIDwvdGQ+XG4gICAgICAgIDx0ZCBjbGFzcz1cIm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19rZXlzX190ZXh0XCI+e3sgaG90a2V5LmRlc2NyaXB0aW9uIH19PC90ZD5cbiAgICAgIDwvdHI+XG4gICAgICA8L3Rib2R5PlxuICAgIDwvdGFibGU+XG4gICAgPGRpdiBjbGFzcz1cIm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19jbG9zZVwiIChjbGljayk9XCJ0b2dnbGVDaGVhdFNoZWV0KClcIj4mIzIxNTs8L2Rpdj5cbiAgPC9kaXY+XG48L2Rpdj5cbmAsXG4gIHN0eWxlczogW2Aubmd4LWNoZWF0c2hlZXR7ZGlzcGxheTp0YWJsZSFpbXBvcnRhbnQ7cG9zaXRpb246Zml4ZWQ7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt0b3A6MDtsZWZ0OjA7Y29sb3I6IzMzMztmb250LXNpemU6MWVtO2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuOSl9Lm5neC1jaGVhdHNoZWV0LmZhZGV7ei1pbmRleDotMTAyNDt2aXNpYmlsaXR5OmhpZGRlbjtvcGFjaXR5OjA7dHJhbnNpdGlvbjpvcGFjaXR5IC4xNXMgbGluZWFyfS5uZ3gtY2hlYXRzaGVldC5mYWRlLmlue3otaW5kZXg6MTAwMDI7dmlzaWJpbGl0eTp2aXNpYmxlO29wYWNpdHk6MX0ubmd4LWNoZWF0c2hlZXRfX2hvdGtleXN7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtkaXNwbGF5OnRhYmxlLWNlbGw7dmVydGljYWwtYWxpZ246bWlkZGxlfS5uZ3gtY2hlYXRzaGVldF9faG90a2V5c19fdGl0bGV7Zm9udC13ZWlnaHQ6NzAwO3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxLjJlbX0ubmd4LWNoZWF0c2hlZXRfX2hvdGtleXMgdGFibGV7bWFyZ2luOmF1dG87Y29sb3I6IzMzM30ubmd4LWNoZWF0c2hlZXRfX2hvdGtleXNfX2tleXN7cGFkZGluZzo1cHg7dGV4dC1hbGlnbjpyaWdodH0ubmd4LWNoZWF0c2hlZXRfX2hvdGtleXNfX2tleXNfX2tleXtkaXNwbGF5OmlubGluZS1ibG9jaztjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6IzMzMztib3JkZXI6MXB4IHNvbGlkICMzMzM7Ym9yZGVyLXJhZGl1czo1cHg7dGV4dC1hbGlnbjpjZW50ZXI7bWFyZ2luLXJpZ2h0OjVweDtib3gtc2hhZG93Omluc2V0IDAgMXB4IDAgIzY2NiwwIDFweCAwICNiYmI7cGFkZGluZzo1cHggOXB4O2ZvbnQtc2l6ZToxZW19Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19rZXlzX190ZXh0e3BhZGRpbmctbGVmdDoxMHB4O2ZvbnQtc2l6ZToxZW19Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19jbG9zZXtwb3NpdGlvbjpmaXhlZDt0b3A6MjBweDtyaWdodDoyMHB4O2ZvbnQtc2l6ZToyZW07Zm9udC13ZWlnaHQ6NzAwO3BhZGRpbmc6NXB4IDEwcHg7Ym9yZGVyOjFweCBzb2xpZCAjZGRkO2JvcmRlci1yYWRpdXM6NXB4O21pbi1oZWlnaHQ6NDVweDttaW4td2lkdGg6NDVweDt0ZXh0LWFsaWduOmNlbnRlcn1AbWVkaWEgYWxsIGFuZCAobWF4LXdpZHRoOjUwMHB4KXsubmd4LWNoZWF0c2hlZXRfX2hvdGtleXN7Zm9udC1zaXplOi44ZW19fUBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6NzUwcHgpey5uZ3gtY2hlYXRzaGVldF9faG90a2V5c3tmb250LXNpemU6MS4yZW19fWBdXG59KVxuZXhwb3J0IGNsYXNzIE5neENoZWF0c2hlZXRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cbiAgQElucHV0KClcbiAgdGl0bGU6IHN0cmluZztcblxuICBoZWxwVmlzaWJsZSA9IGZhbHNlO1xuICBob3RrZXlzOiBJSG90a2V5W107XG5cbiAgcHJpdmF0ZSBfc3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cbiAgcHJpdmF0ZSBfbWFwOiBhbnkgPSB7XG4gICAgY29tbWFuZDogJ1xcdTIzMTgnLCAgICAgICAvLyDijJhcbiAgICBzaGlmdDogJ1xcdTIxRTcnLCAgICAgICAgIC8vIOKHp1xuICAgIGxlZnQ6ICdcXHUyMTkwJywgICAgICAgICAgLy8g4oaQXG4gICAgcmlnaHQ6ICdcXHUyMTkyJywgICAgICAgICAvLyDihpJcbiAgICB1cDogJ1xcdTIxOTEnLCAgICAgICAgICAgIC8vIOKGkVxuICAgIGRvd246ICdcXHUyMTkzJywgICAgICAgICAgLy8g4oaTXG4gICAgJ3JldHVybic6ICdcXHUyM0NFJywgICAgICAvLyDij45cbiAgICBiYWNrc3BhY2U6ICdcXHUyMzJCJyAgICAgIC8vIOKMq1xuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaG90a2V5c1NlcnZpY2U6IE5neEhvdGtleXNTZXJ2aWNlKSB7XG4gICAgdGhpcy50aXRsZSA9IHRoaXMuaG90a2V5c1NlcnZpY2Uub3B0aW9ucy5jaGVhdFNoZWV0VGl0bGU7XG4gIH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLl9zdWJzY3JpcHRpb24gPSB0aGlzLmhvdGtleXNTZXJ2aWNlLmNoZWF0U2hlZXRUb2dnbGVkXG4gICAgICAuc3Vic2NyaWJlKChpc09wZW4pID0+IHtcbiAgICAgICAgaWYgKGlzT3BlbiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLmhvdGtleXMgPSB0aGlzLmhvdGtleXNTZXJ2aWNlLmhvdGtleXNcbiAgICAgICAgICAgIC5maWx0ZXIoaG90a2V5ID0+IGhvdGtleS5kZXNjcmlwdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNPcGVuID09PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuaGVscFZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZUNoZWF0U2hlZXQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBmb3JtYXRIb3RrZXkoaG90a2V5OiBJSG90a2V5KTogc3RyaW5nW10ge1xuICAgIGlmICghaG90a2V5LmZvcm1hdCkge1xuICAgICAgY29uc3QgY29tYm86IHN0cmluZyA9IEFycmF5LmlzQXJyYXkoaG90a2V5LmNvbWJvKSA/IGhvdGtleS5jb21ib1swXSA6IGhvdGtleS5jb21ibztcbiAgICAgIGNvbnN0IHNlcXVlbmNlOiBzdHJpbmdbXSA9IGNvbWJvLnNwbGl0KC9bXFxzXS8pO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZXF1ZW5jZS5sZW5ndGg7IGkrKykge1xuICAgICAgICBzZXF1ZW5jZVtpXSA9IHRoaXMuc3ltYm9saXplKHNlcXVlbmNlW2ldKTtcbiAgICAgIH1cbiAgICAgIGhvdGtleS5mb3JtYXQgPSBzZXF1ZW5jZTtcbiAgICB9XG4gICAgcmV0dXJuIGhvdGtleS5mb3JtYXQ7XG4gIH1cblxuICBwcml2YXRlIHN5bWJvbGl6ZShjb21ibzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBjb21ib1NwbGl0OiBzdHJpbmdbXSA9IGNvbWJvLnNwbGl0KCcrJyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21ib1NwbGl0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAvLyB0cnkgdG8gcmVzb2x2ZSBjb21tYW5kIC8gY3RybCBiYXNlZCBvbiBPUzpcbiAgICAgIGlmIChjb21ib1NwbGl0W2ldID09PSAnbW9kJykge1xuICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvciAmJiB3aW5kb3cubmF2aWdhdG9yLnBsYXRmb3JtLmluZGV4T2YoJ01hYycpID49IDApIHtcbiAgICAgICAgICBjb21ib1NwbGl0W2ldID0gJ2NvbW1hbmQnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbWJvU3BsaXRbaV0gPSAnY3RybCc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbWJvU3BsaXRbaV0gPSB0aGlzLl9tYXBbY29tYm9TcGxpdFtpXV0gfHwgY29tYm9TcGxpdFtpXTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbWJvU3BsaXQuam9pbignICsgJyk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fc3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgdG9nZ2xlQ2hlYXRTaGVldCgpOiB2b2lkIHtcbiAgICB0aGlzLmhlbHBWaXNpYmxlID0gIXRoaXMuaGVscFZpc2libGU7XG4gIH1cbn1cbiJdfQ==