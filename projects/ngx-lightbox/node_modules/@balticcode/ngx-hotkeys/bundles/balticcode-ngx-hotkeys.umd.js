(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('mousetrap'), require('rxjs/internal/operators'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('@balticcode/ngx-hotkeys', ['exports', '@angular/core', 'rxjs', 'mousetrap', 'rxjs/internal/operators', '@angular/common'], factory) :
    (factory((global.balticcode = global.balticcode || {}, global.balticcode['ngx-hotkeys'] = {}),global.ng.core,global.rxjs,null,global.rxjs['internal/operators'],global.ng.common));
}(this, (function (exports,core,rxjs,mousetrap,operators,common) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var /** @type {?} */ HotkeyOptions = new core.InjectionToken('HotkeyOptions');

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var /** @type {?} */ _defaultOptions = {
        disableCheatSheet: false,
        cheatSheetTitle: 'Keyboard Shortcuts:',
        cheatSheetHotkey: '?',
        cheatSheetHotkeyDescription: 'Show / hide this help menu',
        cheatSheetCloseEsc: false,
        cheatSheetCloseEscDescription: 'Hide this help menu'
    };
    var NgxHotkeysService = (function () {
        function NgxHotkeysService(_options) {
            this._options = _options;
            this._registeredHotkeys = new Set();
            this._pausedHotkeys = new Set();
            this._cheatSheetToggled = new rxjs.Subject();
            this._preventIn = ['INPUT', 'SELECT', 'TEXTAREA'];
            this._serviceOptions = Object.assign(_defaultOptions, this._options);
            Mousetrap.prototype.stopCallback = function (event, element, combo, callback) {
                // if the element has the class "mousetrap" then no need to stop
                if ((' ' + element.className + ' ').indexOf(' mousetrap ') > -1) {
                    return false;
                }
                return (element.contentEditable && element.contentEditable === 'true');
            };
            this._mousetrapInstance = new ((Mousetrap))();
            if (!this._serviceOptions.disableCheatSheet) {
                this.register({
                    combo: this._serviceOptions.cheatSheetHotkey,
                    handler: function (event) {
                        this._cheatSheetToggled.next();
                    }.bind(this),
                    description: this._serviceOptions.cheatSheetHotkeyDescription
                });
            }
            if (this._serviceOptions.cheatSheetCloseEsc) {
                this.register({
                    combo: 'esc',
                    handler: function (event) {
                        this._cheatSheetToggled.next(false);
                    }.bind(this),
                    allowIn: ['HOTKEYS-CHEATSHEET'],
                    description: this._serviceOptions.cheatSheetCloseEscDescription
                });
            }
        }
        Object.defineProperty(NgxHotkeysService.prototype, "hotkeys", {
            get: /**
             * Returns the registered hotkeys as array.
             * @return {?} all registered hotkeys
             */ function () {
                return Array.from(this._registeredHotkeys);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(NgxHotkeysService.prototype, "cheatSheetToggled", {
            get: /**
             * Returns an Observable stream indicating the cheatsheets visibility was toggled.
             * @return {?} stream indicating the cheatsheets visibility was toggled
             */ function () {
                return this._cheatSheetToggled.asObservable().pipe(operators.share());
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(NgxHotkeysService.prototype, "options", {
            get: /**
             * @return {?}
             */ function () {
                return this._serviceOptions;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Registers a new hotkey/new hotkeys with it's/their handler(s).
         * @param {?} hotkey hotkeys to listen for
         * @param {?=} unpausing flag indicating if the hotkeys should be unpaused
         * @return {?}
         */
        NgxHotkeysService.prototype.register = /**
         * Registers a new hotkey/new hotkeys with it's/their handler(s).
         * @param {?} hotkey hotkeys to listen for
         * @param {?=} unpausing flag indicating if the hotkeys should be unpaused
         * @return {?}
         */
            function (hotkey, unpausing) {
                var _this = this;
                if (unpausing === void 0) {
                    unpausing = false;
                }
                var /** @type {?} */ hotkeys = [].concat(hotkey);
                if (unpausing) {
                    hotkeys = Array.from(this._pausedHotkeys);
                }
                hotkeys.forEach(function (h) {
                    if (unpausing) {
                        _this._pausedHotkeys.delete(h);
                    }
                    _this._registeredHotkeys.add(h);
                    _this.bindToMoustrap(h);
                });
            };
        /**
         * Removes a/the registered hotkey(s).
         * @param {?} hotkey hotkey filter
         * @param {?=} pausing flag indicating if the hotkeys should be paused
         * @return {?}
         */
        NgxHotkeysService.prototype.unregister = /**
         * Removes a/the registered hotkey(s).
         * @param {?} hotkey hotkey filter
         * @param {?=} pausing flag indicating if the hotkeys should be paused
         * @return {?}
         */
            function (hotkey, pausing) {
                var _this = this;
                if (pausing === void 0) {
                    pausing = false;
                }
                var /** @type {?} */ hotkeys = [].concat(hotkey);
                hotkeys.forEach(function (h) {
                    _this._registeredHotkeys.delete(h);
                    if (pausing) {
                        _this._pausedHotkeys.add(h);
                    }
                    _this._mousetrapInstance.unbind(h.combo, h.specificEvent);
                });
            };
        /**
         * Returns all hotkeys matching the passed combo(s).
         * @param {?=} combo combo to match against
         * @return {?} all matched hotkeys
         */
        NgxHotkeysService.prototype.get = /**
         * Returns all hotkeys matching the passed combo(s).
         * @param {?=} combo combo to match against
         * @return {?} all matched hotkeys
         */
            function (combo) {
                return this.hotkeys.filter(function (h) { return h.combo === combo; });
            };
        /**
         * Stops listening for the specified hotkeys.
         * @param {?=} hotkey hotkey filter
         * @return {?}
         */
        NgxHotkeysService.prototype.pause = /**
         * Stops listening for the specified hotkeys.
         * @param {?=} hotkey hotkey filter
         * @return {?}
         */
            function (hotkey) {
                if (!hotkey) {
                    return this.pause(this.hotkeys);
                }
                var /** @type {?} */ hotkeys = [].concat(hotkey);
                this.unregister(hotkeys, true);
            };
        /**
         * Resumes listening for the specified hotkeys.
         * @param {?=} hotkey hotkey filter
         * @return {?}
         */
        NgxHotkeysService.prototype.unpause = /**
         * Resumes listening for the specified hotkeys.
         * @param {?=} hotkey hotkey filter
         * @return {?}
         */
            function (hotkey) {
                if (!hotkey) {
                    return this.unpause(this.hotkeys);
                }
                var /** @type {?} */ hotkeys = [].concat(hotkey);
                this.register(hotkeys, true);
            };
        /**
         * Resets all hotkeys.
         * @return {?}
         */
        NgxHotkeysService.prototype.reset = /**
         * Resets all hotkeys.
         * @return {?}
         */
            function () {
                this._mousetrapInstance.reset();
                this._registeredHotkeys.clear();
                this._pausedHotkeys.clear();
            };
        /**
         * @return {?}
         */
        NgxHotkeysService.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.reset();
            };
        /**
         * @param {?} hotkey
         * @return {?}
         */
        NgxHotkeysService.prototype.bindToMoustrap = /**
         * @param {?} hotkey
         * @return {?}
         */
            function (hotkey) {
                var _this = this;
                this._mousetrapInstance.bind(hotkey.combo, function (event, combo) {
                    var /** @type {?} */ shouldExecute = true;
                    // if the callback is executed directly `hotkey.get('w').callback()`
                    // there will be no event, so just execute the callback.
                    if (event) {
                        var /** @type {?} */ target = ((event.target || event.srcElement)); // srcElement is IE only
                        var /** @type {?} */ nodeName = target.nodeName.toUpperCase();
                        // check if the input has a mousetrap class, and skip checking preventIn if so
                        if ((' ' + target.className + ' ').indexOf(' mousetrap ') > -1) {
                            shouldExecute = true;
                        }
                        else if (_this._preventIn.indexOf(nodeName) > -1 && hotkey.allowIn.map(function (allow) { return allow.toUpperCase(); }).indexOf(nodeName) === -1) {
                            // don't execute callback if the event was fired from inside an element listed in preventIn but not in allowIn
                            shouldExecute = false;
                        }
                    }
                    if (shouldExecute) {
                        return hotkey.handler.apply(_this, [event, combo]);
                    }
                }, hotkey.specificEvent);
            };
        NgxHotkeysService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        NgxHotkeysService.ctorParameters = function () {
            return [
                { type: undefined, decorators: [{ type: core.Inject, args: [HotkeyOptions,] },] },
            ];
        };
        return NgxHotkeysService;
    }());

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m)
            return m.call(o);
        return {
            next: function () {
                if (o && i >= o.length)
                    o = void 0;
                return { value: o && o[i++], done: !o };
            }
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var NgxHotkeysDirective = (function () {
        function NgxHotkeysDirective(_hotkeysService, _elementRef) {
            this._hotkeysService = _hotkeysService;
            this._elementRef = _elementRef;
            this._hotkeysList = [];
            this._oldHotkeys = [];
            this._mousetrapInstance = new Mousetrap(this._elementRef.nativeElement); // Bind hotkeys to the current element (and any children)
        }
        /**
         * @return {?}
         */
        NgxHotkeysDirective.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                try {
                    for (var _a = __values(this.hotkeys), _b = _a.next(); !_b.done; _b = _a.next()) {
                        var hotkey = _b.value;
                        var /** @type {?} */ combo = Object.keys(hotkey)[0];
                        var /** @type {?} */ hotkeyObj = {
                            combo: combo,
                            handler: hotkey[combo]
                        };
                        var /** @type {?} */ filtered = this._hotkeysService.get(combo);
                        var /** @type {?} */ oldHotkey = !!filtered && !!filtered.length ? filtered[0] : null;
                        if (oldHotkey !== null) {
                            // We let the user overwrite callbacks temporarily if you specify it in HTML
                            this._oldHotkeys.push(oldHotkey);
                            this._hotkeysService.unregister(oldHotkey);
                        }
                        this._hotkeysList.push(hotkeyObj);
                        this._mousetrapInstance.bind(hotkeyObj.combo, hotkeyObj.handler);
                    }
                }
                catch (e_1_1) {
                    e_1 = { error: e_1_1 };
                }
                finally {
                    try {
                        if (_b && !_b.done && (_c = _a.return))
                            _c.call(_a);
                    }
                    finally {
                        if (e_1)
                            throw e_1.error;
                    }
                }
                var e_1, _c;
            };
        /**
         * @return {?}
         */
        NgxHotkeysDirective.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                try {
                    for (var _a = __values(this._hotkeysList), _b = _a.next(); !_b.done; _b = _a.next()) {
                        var hotkey = _b.value;
                        this._mousetrapInstance.unbind(hotkey.combo);
                    }
                }
                catch (e_2_1) {
                    e_2 = { error: e_2_1 };
                }
                finally {
                    try {
                        if (_b && !_b.done && (_c = _a.return))
                            _c.call(_a);
                    }
                    finally {
                        if (e_2)
                            throw e_2.error;
                    }
                }
                this._hotkeysService.register(this._oldHotkeys);
                var e_2, _c;
            };
        NgxHotkeysDirective.decorators = [
            { type: core.Directive, args: [{
                        selector: '[ngxHotkeys]',
                        providers: [NgxHotkeysService]
                    },] },
        ];
        /** @nocollapse */
        NgxHotkeysDirective.ctorParameters = function () {
            return [
                { type: NgxHotkeysService, },
                { type: core.ElementRef, },
            ];
        };
        NgxHotkeysDirective.propDecorators = {
            "hotkeys": [{ type: core.Input },],
        };
        return NgxHotkeysDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var NgxCheatsheetComponent = (function () {
        function NgxCheatsheetComponent(hotkeysService) {
            this.hotkeysService = hotkeysService;
            this.helpVisible = false;
            this._map = {
                command: '\u2318',
                // ⌘
                shift: '\u21E7',
                // ⇧
                left: '\u2190',
                // ←
                right: '\u2192',
                // →
                up: '\u2191',
                // ↑
                down: '\u2193',
                // ↓
                'return': '\u23CE',
                // ⏎
                backspace: '\u232B' // ⌫
            };
            this.title = this.hotkeysService.options.cheatSheetTitle;
        }
        /**
         * @return {?}
         */
        NgxCheatsheetComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this._subscription = this.hotkeysService.cheatSheetToggled
                    .subscribe(function (isOpen) {
                    if (isOpen !== false) {
                        _this.hotkeys = _this.hotkeysService.hotkeys
                            .filter(function (hotkey) { return hotkey.description; });
                    }
                    if (isOpen === false) {
                        _this.helpVisible = false;
                    }
                    else {
                        _this.toggleCheatSheet();
                    }
                });
            };
        /**
         * @param {?} hotkey
         * @return {?}
         */
        NgxCheatsheetComponent.prototype.formatHotkey = /**
         * @param {?} hotkey
         * @return {?}
         */
            function (hotkey) {
                if (!hotkey.format) {
                    var /** @type {?} */ combo = Array.isArray(hotkey.combo) ? hotkey.combo[0] : hotkey.combo;
                    var /** @type {?} */ sequence = combo.split(/[\s]/);
                    for (var /** @type {?} */ i = 0; i < sequence.length; i++) {
                        sequence[i] = this.symbolize(sequence[i]);
                    }
                    hotkey.format = sequence;
                }
                return hotkey.format;
            };
        /**
         * @param {?} combo
         * @return {?}
         */
        NgxCheatsheetComponent.prototype.symbolize = /**
         * @param {?} combo
         * @return {?}
         */
            function (combo) {
                var /** @type {?} */ comboSplit = combo.split('+');
                for (var /** @type {?} */ i = 0; i < comboSplit.length; i++) {
                    // try to resolve command / ctrl based on OS:
                    if (comboSplit[i] === 'mod') {
                        if (window.navigator && window.navigator.platform.indexOf('Mac') >= 0) {
                            comboSplit[i] = 'command';
                        }
                        else {
                            comboSplit[i] = 'ctrl';
                        }
                    }
                    comboSplit[i] = this._map[comboSplit[i]] || comboSplit[i];
                }
                return comboSplit.join(' + ');
            };
        /**
         * @return {?}
         */
        NgxCheatsheetComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                if (this._subscription) {
                    this._subscription.unsubscribe();
                }
            };
        /**
         * @return {?}
         */
        NgxCheatsheetComponent.prototype.toggleCheatSheet = /**
         * @return {?}
         */
            function () {
                this.helpVisible = !this.helpVisible;
            };
        NgxCheatsheetComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'ngx-cheatsheet',
                        template: "<div class=\"ngx-cheatsheet fade\" [ngClass]=\"{'in': helpVisible}\" style=\"display:none\">\n  <div class=\"ngx-cheatsheet__hotkeys\">\n    <h4 class=\"ngx-cheatsheet__hotkeys__title\">{{ title }}</h4>\n    <table>\n      <tbody>\n      <tr *ngFor=\"let hotkey of hotkeys\">\n        <td class=\"ngx-cheatsheet__hotkeys__keys\">\n          <span class=\"ngx-cheatsheet__hotkeys__keys__key\">{{ formatHotkey(hotkey) }}</span>\n        </td>\n        <td class=\"ngx-cheatsheet__hotkeys__keys__text\">{{ hotkey.description }}</td>\n      </tr>\n      </tbody>\n    </table>\n    <div class=\"ngx-cheatsheet__hotkeys__close\" (click)=\"toggleCheatSheet()\">&#215;</div>\n  </div>\n</div>\n",
                        styles: [".ngx-cheatsheet{display:table!important;position:fixed;width:100%;height:100%;top:0;left:0;color:#333;font-size:1em;background-color:rgba(255,255,255,.9)}.ngx-cheatsheet.fade{z-index:-1024;visibility:hidden;opacity:0;transition:opacity .15s linear}.ngx-cheatsheet.fade.in{z-index:10002;visibility:visible;opacity:1}.ngx-cheatsheet__hotkeys{width:100%;height:100%;display:table-cell;vertical-align:middle}.ngx-cheatsheet__hotkeys__title{font-weight:700;text-align:center;font-size:1.2em}.ngx-cheatsheet__hotkeys table{margin:auto;color:#333}.ngx-cheatsheet__hotkeys__keys{padding:5px;text-align:right}.ngx-cheatsheet__hotkeys__keys__key{display:inline-block;color:#fff;background-color:#333;border:1px solid #333;border-radius:5px;text-align:center;margin-right:5px;box-shadow:inset 0 1px 0 #666,0 1px 0 #bbb;padding:5px 9px;font-size:1em}.ngx-cheatsheet__hotkeys__keys__text{padding-left:10px;font-size:1em}.ngx-cheatsheet__hotkeys__close{position:fixed;top:20px;right:20px;font-size:2em;font-weight:700;padding:5px 10px;border:1px solid #ddd;border-radius:5px;min-height:45px;min-width:45px;text-align:center}@media all and (max-width:500px){.ngx-cheatsheet__hotkeys{font-size:.8em}}@media all and (min-width:750px){.ngx-cheatsheet__hotkeys{font-size:1.2em}}"]
                    },] },
        ];
        /** @nocollapse */
        NgxCheatsheetComponent.ctorParameters = function () {
            return [
                { type: NgxHotkeysService, },
            ];
        };
        NgxCheatsheetComponent.propDecorators = {
            "title": [{ type: core.Input },],
        };
        return NgxCheatsheetComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var NgxHotkeysModule = (function () {
        function NgxHotkeysModule() {
        }
        /**
         * @param {?=} options
         * @return {?}
         */
        NgxHotkeysModule.forRoot = /**
         * @param {?=} options
         * @return {?}
         */
            function (options) {
                return {
                    ngModule: NgxHotkeysModule,
                    providers: [
                        NgxHotkeysService,
                        { provide: HotkeyOptions, useValue: options }
                    ]
                };
            };
        NgxHotkeysModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [common.CommonModule],
                        declarations: [NgxCheatsheetComponent, NgxHotkeysDirective],
                        exports: [NgxHotkeysDirective, NgxCheatsheetComponent],
                        providers: [NgxHotkeysService]
                    },] },
        ];
        return NgxHotkeysModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.NgxHotkeysService = NgxHotkeysService;
    exports.NgxHotkeysDirective = NgxHotkeysDirective;
    exports.NgxCheatsheetComponent = NgxCheatsheetComponent;
    exports.NgxHotkeysModule = NgxHotkeysModule;
    exports.ɵa = HotkeyOptions;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFsdGljY29kZS1uZ3gtaG90a2V5cy51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL0BiYWx0aWNjb2RlL25neC1ob3RrZXlzL2xpYi90b2tlbi50cyIsIm5nOi8vQGJhbHRpY2NvZGUvbmd4LWhvdGtleXMvbGliL25neC1ob3RrZXlzLnNlcnZpY2UudHMiLG51bGwsIm5nOi8vQGJhbHRpY2NvZGUvbmd4LWhvdGtleXMvbGliL25neC1ob3RrZXlzLmRpcmVjdGl2ZS50cyIsIm5nOi8vQGJhbHRpY2NvZGUvbmd4LWhvdGtleXMvbGliL25neC1jaGVhdHNoZWV0L25neC1jaGVhdHNoZWV0LmNvbXBvbmVudC50cyIsIm5nOi8vQGJhbHRpY2NvZGUvbmd4LWhvdGtleXMvbGliL25neC1ob3RrZXlzLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdGlvblRva2VufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7SUhvdGtleU9wdGlvbnN9IGZyb20gJy4vaW50ZXJmYWNlcyc7XHJcblxyXG5leHBvcnQgY29uc3QgSG90a2V5T3B0aW9ucyA9IG5ldyBJbmplY3Rpb25Ub2tlbjxJSG90a2V5T3B0aW9ucz4oJ0hvdGtleU9wdGlvbnMnKTtcclxuIiwiaW1wb3J0IHtJbmplY3QsIEluamVjdGFibGUsIE9uRGVzdHJveX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge09ic2VydmFibGUsIFN1YmplY3R9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgJ21vdXNldHJhcCc7XG5cbmltcG9ydCB7SUhvdGtleSwgSUhvdGtleU9wdGlvbnN9IGZyb20gJy4vaW50ZXJmYWNlcyc7XG5pbXBvcnQge0hvdGtleU9wdGlvbnN9IGZyb20gJy4vdG9rZW4nO1xuaW1wb3J0IHtzaGFyZX0gZnJvbSAncnhqcy9pbnRlcm5hbC9vcGVyYXRvcnMnO1xuXG5jb25zdCBfZGVmYXVsdE9wdGlvbnM6IElIb3RrZXlPcHRpb25zID0ge1xuICBkaXNhYmxlQ2hlYXRTaGVldDogZmFsc2UsXG4gIGNoZWF0U2hlZXRUaXRsZTogJ0tleWJvYXJkIFNob3J0Y3V0czonLFxuICBjaGVhdFNoZWV0SG90a2V5OiAnPycsXG4gIGNoZWF0U2hlZXRIb3RrZXlEZXNjcmlwdGlvbjogJ1Nob3cgLyBoaWRlIHRoaXMgaGVscCBtZW51JyxcbiAgY2hlYXRTaGVldENsb3NlRXNjOiBmYWxzZSxcbiAgY2hlYXRTaGVldENsb3NlRXNjRGVzY3JpcHRpb246ICdIaWRlIHRoaXMgaGVscCBtZW51J1xufTtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIE5neEhvdGtleXNTZXJ2aWNlIGltcGxlbWVudHMgT25EZXN0cm95IHtcblxuICBwcml2YXRlIF9zZXJ2aWNlT3B0aW9uczogSUhvdGtleU9wdGlvbnM7XG4gIHByaXZhdGUgX3JlZ2lzdGVyZWRIb3RrZXlzOiBTZXQ8SUhvdGtleT4gPSBuZXcgU2V0KCk7XG4gIHByaXZhdGUgX3BhdXNlZEhvdGtleXM6IFNldDxJSG90a2V5PiA9IG5ldyBTZXQoKTtcbiAgcHJpdmF0ZSBfbW91c2V0cmFwSW5zdGFuY2U6IE1vdXNldHJhcEluc3RhbmNlO1xuICBwcml2YXRlIF9jaGVhdFNoZWV0VG9nZ2xlZDogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3QoKTtcbiAgcHJpdmF0ZSBfcHJldmVudEluID0gWydJTlBVVCcsICdTRUxFQ1QnLCAnVEVYVEFSRUEnXTtcblxuICBjb25zdHJ1Y3RvcihASW5qZWN0KEhvdGtleU9wdGlvbnMpIHByaXZhdGUgX29wdGlvbnM6IElIb3RrZXlPcHRpb25zKSB7XG4gICAgdGhpcy5fc2VydmljZU9wdGlvbnMgPSBPYmplY3QuYXNzaWduKF9kZWZhdWx0T3B0aW9ucywgdGhpcy5fb3B0aW9ucyk7XG4gICAgTW91c2V0cmFwLnByb3RvdHlwZS5zdG9wQ2FsbGJhY2sgPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQsIGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBjb21ibzogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pID0+IHtcbiAgICAgIC8vIGlmIHRoZSBlbGVtZW50IGhhcyB0aGUgY2xhc3MgXCJtb3VzZXRyYXBcIiB0aGVuIG5vIG5lZWQgdG8gc3RvcFxuICAgICAgaWYgKCgnICcgKyBlbGVtZW50LmNsYXNzTmFtZSArICcgJykuaW5kZXhPZignIG1vdXNldHJhcCAnKSA+IC0xKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoZWxlbWVudC5jb250ZW50RWRpdGFibGUgJiYgZWxlbWVudC5jb250ZW50RWRpdGFibGUgPT09ICd0cnVlJyk7XG4gICAgfTtcbiAgICB0aGlzLl9tb3VzZXRyYXBJbnN0YW5jZSA9IG5ldyAoPGFueT5Nb3VzZXRyYXApKCk7XG4gICAgaWYgKCF0aGlzLl9zZXJ2aWNlT3B0aW9ucy5kaXNhYmxlQ2hlYXRTaGVldCkge1xuICAgICAgdGhpcy5yZWdpc3Rlcih7XG4gICAgICAgIGNvbWJvOiB0aGlzLl9zZXJ2aWNlT3B0aW9ucy5jaGVhdFNoZWV0SG90a2V5LFxuICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgICB0aGlzLl9jaGVhdFNoZWV0VG9nZ2xlZC5uZXh0KCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3NlcnZpY2VPcHRpb25zLmNoZWF0U2hlZXRIb3RrZXlEZXNjcmlwdGlvblxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3NlcnZpY2VPcHRpb25zLmNoZWF0U2hlZXRDbG9zZUVzYykge1xuICAgICAgdGhpcy5yZWdpc3Rlcih7XG4gICAgICAgIGNvbWJvOiAnZXNjJyxcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgICAgdGhpcy5fY2hlYXRTaGVldFRvZ2dsZWQubmV4dChmYWxzZSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgICAgYWxsb3dJbjogWydIT1RLRVlTLUNIRUFUU0hFRVQnXSxcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3NlcnZpY2VPcHRpb25zLmNoZWF0U2hlZXRDbG9zZUVzY0Rlc2NyaXB0aW9uXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcmVnaXN0ZXJlZCBob3RrZXlzIGFzIGFycmF5LlxuICAgKiBAcmV0dXJucyBhbGwgcmVnaXN0ZXJlZCBob3RrZXlzXG4gICAqL1xuICBwdWJsaWMgZ2V0IGhvdGtleXMoKTogSUhvdGtleVtdIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9yZWdpc3RlcmVkSG90a2V5cyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbiBPYnNlcnZhYmxlIHN0cmVhbSBpbmRpY2F0aW5nIHRoZSBjaGVhdHNoZWV0cyB2aXNpYmlsaXR5IHdhcyB0b2dnbGVkLlxuICAgKiBAcmV0dXJucyBzdHJlYW0gaW5kaWNhdGluZyB0aGUgY2hlYXRzaGVldHMgdmlzaWJpbGl0eSB3YXMgdG9nZ2xlZFxuICAgKi9cbiAgcHVibGljIGdldCBjaGVhdFNoZWV0VG9nZ2xlZCgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gdGhpcy5fY2hlYXRTaGVldFRvZ2dsZWQuYXNPYnNlcnZhYmxlKCkucGlwZShcbiAgICAgIHNoYXJlKClcbiAgICApO1xuICB9XG5cbiAgcHVibGljIGdldCBvcHRpb25zKCk6IElIb3RrZXlPcHRpb25zIHtcbiAgICByZXR1cm4gdGhpcy5fc2VydmljZU9wdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgbmV3IGhvdGtleS9uZXcgaG90a2V5cyB3aXRoIGl0J3MvdGhlaXIgaGFuZGxlcihzKS5cbiAgICogQHBhcmFtIGhvdGtleSBob3RrZXlzIHRvIGxpc3RlbiBmb3JcbiAgICogQHBhcmFtIHVucGF1c2luZyBmbGFnIGluZGljYXRpbmcgaWYgdGhlIGhvdGtleXMgc2hvdWxkIGJlIHVucGF1c2VkXG4gICAqL1xuICBwdWJsaWMgcmVnaXN0ZXIoaG90a2V5OiBJSG90a2V5IHwgSUhvdGtleVtdLCB1bnBhdXNpbmcgPSBmYWxzZSk6IHZvaWQge1xuICAgIGxldCBob3RrZXlzOiBJSG90a2V5W10gPSBbXS5jb25jYXQoaG90a2V5KTtcbiAgICBpZiAodW5wYXVzaW5nKSB7XG4gICAgICBob3RrZXlzID0gQXJyYXkuZnJvbSh0aGlzLl9wYXVzZWRIb3RrZXlzKTtcbiAgICB9XG4gICAgaG90a2V5cy5mb3JFYWNoKGggPT4ge1xuICAgICAgaWYgKHVucGF1c2luZykge1xuICAgICAgICB0aGlzLl9wYXVzZWRIb3RrZXlzLmRlbGV0ZShoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3JlZ2lzdGVyZWRIb3RrZXlzLmFkZChoKTtcbiAgICAgIHRoaXMuYmluZFRvTW91c3RyYXAoaCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhL3RoZSByZWdpc3RlcmVkIGhvdGtleShzKS5cbiAgICogQHBhcmFtIGhvdGtleSBob3RrZXkgZmlsdGVyXG4gICAqIEBwYXJhbSBwYXVzaW5nIGZsYWcgaW5kaWNhdGluZyBpZiB0aGUgaG90a2V5cyBzaG91bGQgYmUgcGF1c2VkXG4gICAqL1xuICBwdWJsaWMgdW5yZWdpc3Rlcihob3RrZXk6IElIb3RrZXkgfCBJSG90a2V5W10sIHBhdXNpbmcgPSBmYWxzZSk6IHZvaWQge1xuICAgIGNvbnN0IGhvdGtleXM6IElIb3RrZXlbXSA9IFtdLmNvbmNhdChob3RrZXkpO1xuXG4gICAgaG90a2V5cy5mb3JFYWNoKGggPT4ge1xuICAgICAgdGhpcy5fcmVnaXN0ZXJlZEhvdGtleXMuZGVsZXRlKGgpO1xuICAgICAgaWYgKHBhdXNpbmcpIHtcbiAgICAgICAgdGhpcy5fcGF1c2VkSG90a2V5cy5hZGQoaCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9tb3VzZXRyYXBJbnN0YW5jZS51bmJpbmQoaC5jb21ibywgaC5zcGVjaWZpY0V2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFsbCBob3RrZXlzIG1hdGNoaW5nIHRoZSBwYXNzZWQgY29tYm8ocykuXG4gICAqIEBwYXJhbSBjb21ibyBjb21ibyB0byBtYXRjaCBhZ2FpbnN0XG4gICAqIEByZXR1cm5zIGFsbCBtYXRjaGVkIGhvdGtleXNcbiAgICovXG4gIHB1YmxpYyBnZXQoY29tYm8/OiBzdHJpbmcgfCBzdHJpbmdbXSk6IElIb3RrZXlbXSB7XG4gICAgcmV0dXJuIHRoaXMuaG90a2V5cy5maWx0ZXIoaCA9PiBoLmNvbWJvID09PSBjb21ibyk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcHMgbGlzdGVuaW5nIGZvciB0aGUgc3BlY2lmaWVkIGhvdGtleXMuXG4gICAqIEBwYXJhbSBob3RrZXkgaG90a2V5IGZpbHRlclxuICAgKi9cbiAgcHVibGljIHBhdXNlKGhvdGtleT86IElIb3RrZXkgfCBJSG90a2V5W10pOiB2b2lkIHtcbiAgICBpZiAoIWhvdGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMucGF1c2UodGhpcy5ob3RrZXlzKTtcbiAgICB9XG4gICAgY29uc3QgaG90a2V5czogSUhvdGtleVtdID0gW10uY29uY2F0KGhvdGtleSk7XG4gICAgdGhpcy51bnJlZ2lzdGVyKGhvdGtleXMsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc3VtZXMgbGlzdGVuaW5nIGZvciB0aGUgc3BlY2lmaWVkIGhvdGtleXMuXG4gICAqIEBwYXJhbSBob3RrZXkgaG90a2V5IGZpbHRlclxuICAgKi9cbiAgcHVibGljIHVucGF1c2UoaG90a2V5PzogSUhvdGtleSB8IElIb3RrZXlbXSk6IHZvaWQge1xuICAgIGlmICghaG90a2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy51bnBhdXNlKHRoaXMuaG90a2V5cyk7XG4gICAgfVxuICAgIGNvbnN0IGhvdGtleXM6IElIb3RrZXlbXSA9IFtdLmNvbmNhdChob3RrZXkpO1xuICAgIHRoaXMucmVnaXN0ZXIoaG90a2V5cywgdHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmVzZXRzIGFsbCBob3RrZXlzLlxuICAgKi9cbiAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xuICAgIHRoaXMuX21vdXNldHJhcEluc3RhbmNlLnJlc2V0KCk7XG4gICAgdGhpcy5fcmVnaXN0ZXJlZEhvdGtleXMuY2xlYXIoKTtcbiAgICB0aGlzLl9wYXVzZWRIb3RrZXlzLmNsZWFyKCk7XG4gIH1cblxuICBwdWJsaWMgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5yZXNldCgpO1xuICB9XG5cbiAgcHJpdmF0ZSBiaW5kVG9Nb3VzdHJhcChob3RrZXk6IElIb3RrZXkpOiB2b2lkIHtcblxuICAgIHRoaXMuX21vdXNldHJhcEluc3RhbmNlLmJpbmQoaG90a2V5LmNvbWJvLFxuICAgICAgKGV2ZW50OiBLZXlib2FyZEV2ZW50LCBjb21ibzogc3RyaW5nKSA9PiB7XG4gICAgICAgIGxldCBzaG91bGRFeGVjdXRlID0gdHJ1ZTtcblxuICAgICAgICAvLyBpZiB0aGUgY2FsbGJhY2sgaXMgZXhlY3V0ZWQgZGlyZWN0bHkgYGhvdGtleS5nZXQoJ3cnKS5jYWxsYmFjaygpYFxuICAgICAgICAvLyB0aGVyZSB3aWxsIGJlIG5vIGV2ZW50LCBzbyBqdXN0IGV4ZWN1dGUgdGhlIGNhbGxiYWNrLlxuICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICBjb25zdCB0YXJnZXQ6IEhUTUxFbGVtZW50ID0gPEhUTUxFbGVtZW50PihldmVudC50YXJnZXQgfHwgZXZlbnQuc3JjRWxlbWVudCk7IC8vIHNyY0VsZW1lbnQgaXMgSUUgb25seVxuICAgICAgICAgIGNvbnN0IG5vZGVOYW1lOiBzdHJpbmcgPSB0YXJnZXQubm9kZU5hbWUudG9VcHBlckNhc2UoKTtcblxuICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBpbnB1dCBoYXMgYSBtb3VzZXRyYXAgY2xhc3MsIGFuZCBza2lwIGNoZWNraW5nIHByZXZlbnRJbiBpZiBzb1xuICAgICAgICAgIGlmICgoJyAnICsgdGFyZ2V0LmNsYXNzTmFtZSArICcgJykuaW5kZXhPZignIG1vdXNldHJhcCAnKSA+IC0xKSB7XG4gICAgICAgICAgICBzaG91bGRFeGVjdXRlID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3ByZXZlbnRJbi5pbmRleE9mKG5vZGVOYW1lKSA+IC0xICYmIGhvdGtleS5hbGxvd0luLm1hcChhbGxvdyA9PiBhbGxvdy50b1VwcGVyQ2FzZSgpKS5pbmRleE9mKG5vZGVOYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIGRvbid0IGV4ZWN1dGUgY2FsbGJhY2sgaWYgdGhlIGV2ZW50IHdhcyBmaXJlZCBmcm9tIGluc2lkZSBhbiBlbGVtZW50IGxpc3RlZCBpbiBwcmV2ZW50SW4gYnV0IG5vdCBpbiBhbGxvd0luXG4gICAgICAgICAgICBzaG91bGRFeGVjdXRlID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNob3VsZEV4ZWN1dGUpIHtcbiAgICAgICAgICByZXR1cm4gaG90a2V5LmhhbmRsZXIuYXBwbHkodGhpcywgW2V2ZW50LCBjb21ib10pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaG90a2V5LnNwZWNpZmljRXZlbnQpO1xuICB9XG59XG4iLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IHlbb3BbMF0gJiAyID8gXCJyZXR1cm5cIiA6IG9wWzBdID8gXCJ0aHJvd1wiIDogXCJuZXh0XCJdKSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFswLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyAgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaWYgKG9bbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH07IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl07XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHtEaXJlY3RpdmUsIEVsZW1lbnRSZWYsIElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgJ21vdXNldHJhcCc7XHJcblxyXG5pbXBvcnQge0hvdEtleU1hcCwgSUhvdGtleX0gZnJvbSAnLi9pbnRlcmZhY2VzJztcclxuaW1wb3J0IHtOZ3hIb3RrZXlzU2VydmljZX0gZnJvbSAnLi9uZ3gtaG90a2V5cy5zZXJ2aWNlJztcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gIHNlbGVjdG9yOiAnW25neEhvdGtleXNdJyxcclxuICBwcm92aWRlcnM6IFtOZ3hIb3RrZXlzU2VydmljZV1cclxufSlcclxuZXhwb3J0IGNsYXNzIE5neEhvdGtleXNEaXJlY3RpdmUgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgaG90a2V5czogSG90S2V5TWFwW107XHJcblxyXG4gIHByaXZhdGUgX21vdXNldHJhcEluc3RhbmNlOiBNb3VzZXRyYXBJbnN0YW5jZTtcclxuICBwcml2YXRlIF9ob3RrZXlzTGlzdDogSUhvdGtleVtdID0gW107XHJcbiAgcHJpdmF0ZSBfb2xkSG90a2V5czogSUhvdGtleVtdID0gW107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX2hvdGtleXNTZXJ2aWNlOiBOZ3hIb3RrZXlzU2VydmljZSwgcHJpdmF0ZSBfZWxlbWVudFJlZjogRWxlbWVudFJlZikge1xyXG4gICAgdGhpcy5fbW91c2V0cmFwSW5zdGFuY2UgPSBuZXcgTW91c2V0cmFwKHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudCk7IC8vIEJpbmQgaG90a2V5cyB0byB0aGUgY3VycmVudCBlbGVtZW50IChhbmQgYW55IGNoaWxkcmVuKVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICBmb3IgKGNvbnN0IGhvdGtleSBvZiB0aGlzLmhvdGtleXMpIHtcclxuICAgICAgY29uc3QgY29tYm8gPSBPYmplY3Qua2V5cyhob3RrZXkpWzBdO1xyXG4gICAgICBjb25zdCBob3RrZXlPYmo6IElIb3RrZXkgPSB7XHJcbiAgICAgICAgY29tYm86IGNvbWJvLFxyXG4gICAgICAgIGhhbmRsZXI6IGhvdGtleVtjb21ib11cclxuICAgICAgfTtcclxuICAgICAgY29uc3QgZmlsdGVyZWQ6IElIb3RrZXlbXSA9IHRoaXMuX2hvdGtleXNTZXJ2aWNlLmdldChjb21ibyk7XHJcbiAgICAgIGNvbnN0IG9sZEhvdGtleTogSUhvdGtleSA9ICEhZmlsdGVyZWQgJiYgISFmaWx0ZXJlZC5sZW5ndGggPyBmaWx0ZXJlZFswXSA6IG51bGw7XHJcbiAgICAgIGlmIChvbGRIb3RrZXkgIT09IG51bGwpIHsgLy8gV2UgbGV0IHRoZSB1c2VyIG92ZXJ3cml0ZSBjYWxsYmFja3MgdGVtcG9yYXJpbHkgaWYgeW91IHNwZWNpZnkgaXQgaW4gSFRNTFxyXG4gICAgICAgIHRoaXMuX29sZEhvdGtleXMucHVzaChvbGRIb3RrZXkpO1xyXG4gICAgICAgIHRoaXMuX2hvdGtleXNTZXJ2aWNlLnVucmVnaXN0ZXIob2xkSG90a2V5KTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLl9ob3RrZXlzTGlzdC5wdXNoKGhvdGtleU9iaik7XHJcbiAgICAgIHRoaXMuX21vdXNldHJhcEluc3RhbmNlLmJpbmQoaG90a2V5T2JqLmNvbWJvLCBob3RrZXlPYmouaGFuZGxlcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpIHtcclxuICAgIGZvciAoY29uc3QgaG90a2V5IG9mIHRoaXMuX2hvdGtleXNMaXN0KSB7XHJcbiAgICAgIHRoaXMuX21vdXNldHJhcEluc3RhbmNlLnVuYmluZChob3RrZXkuY29tYm8pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faG90a2V5c1NlcnZpY2UucmVnaXN0ZXIodGhpcy5fb2xkSG90a2V5cyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7Q29tcG9uZW50LCBJbnB1dCwgT25EZXN0cm95LCBPbkluaXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge05neEhvdGtleXNTZXJ2aWNlfSBmcm9tICcuLi9uZ3gtaG90a2V5cy5zZXJ2aWNlJztcbmltcG9ydCB7SUhvdGtleX0gZnJvbSAnLi4vaW50ZXJmYWNlcyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25neC1jaGVhdHNoZWV0JyxcbiAgdGVtcGxhdGU6IGA8ZGl2IGNsYXNzPVwibmd4LWNoZWF0c2hlZXQgZmFkZVwiIFtuZ0NsYXNzXT1cInsnaW4nOiBoZWxwVmlzaWJsZX1cIiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPlxuICA8ZGl2IGNsYXNzPVwibmd4LWNoZWF0c2hlZXRfX2hvdGtleXNcIj5cbiAgICA8aDQgY2xhc3M9XCJuZ3gtY2hlYXRzaGVldF9faG90a2V5c19fdGl0bGVcIj57eyB0aXRsZSB9fTwvaDQ+XG4gICAgPHRhYmxlPlxuICAgICAgPHRib2R5PlxuICAgICAgPHRyICpuZ0Zvcj1cImxldCBob3RrZXkgb2YgaG90a2V5c1wiPlxuICAgICAgICA8dGQgY2xhc3M9XCJuZ3gtY2hlYXRzaGVldF9faG90a2V5c19fa2V5c1wiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwibmd4LWNoZWF0c2hlZXRfX2hvdGtleXNfX2tleXNfX2tleVwiPnt7IGZvcm1hdEhvdGtleShob3RrZXkpIH19PC9zcGFuPlxuICAgICAgICA8L3RkPlxuICAgICAgICA8dGQgY2xhc3M9XCJuZ3gtY2hlYXRzaGVldF9faG90a2V5c19fa2V5c19fdGV4dFwiPnt7IGhvdGtleS5kZXNjcmlwdGlvbiB9fTwvdGQ+XG4gICAgICA8L3RyPlxuICAgICAgPC90Ym9keT5cbiAgICA8L3RhYmxlPlxuICAgIDxkaXYgY2xhc3M9XCJuZ3gtY2hlYXRzaGVldF9faG90a2V5c19fY2xvc2VcIiAoY2xpY2spPVwidG9nZ2xlQ2hlYXRTaGVldCgpXCI+JiMyMTU7PC9kaXY+XG4gIDwvZGl2PlxuPC9kaXY+XG5gLFxuICBzdHlsZXM6IFtgLm5neC1jaGVhdHNoZWV0e2Rpc3BsYXk6dGFibGUhaW1wb3J0YW50O3Bvc2l0aW9uOmZpeGVkO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7dG9wOjA7bGVmdDowO2NvbG9yOiMzMzM7Zm9udC1zaXplOjFlbTtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjkpfS5uZ3gtY2hlYXRzaGVldC5mYWRle3otaW5kZXg6LTEwMjQ7dmlzaWJpbGl0eTpoaWRkZW47b3BhY2l0eTowO3RyYW5zaXRpb246b3BhY2l0eSAuMTVzIGxpbmVhcn0ubmd4LWNoZWF0c2hlZXQuZmFkZS5pbnt6LWluZGV4OjEwMDAyO3Zpc2liaWxpdHk6dmlzaWJsZTtvcGFjaXR5OjF9Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlze3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7ZGlzcGxheTp0YWJsZS1jZWxsO3ZlcnRpY2FsLWFsaWduOm1pZGRsZX0ubmd4LWNoZWF0c2hlZXRfX2hvdGtleXNfX3RpdGxle2ZvbnQtd2VpZ2h0OjcwMDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MS4yZW19Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlzIHRhYmxle21hcmdpbjphdXRvO2NvbG9yOiMzMzN9Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19rZXlze3BhZGRpbmc6NXB4O3RleHQtYWxpZ246cmlnaHR9Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlzX19rZXlzX19rZXl7ZGlzcGxheTppbmxpbmUtYmxvY2s7Y29sb3I6I2ZmZjtiYWNrZ3JvdW5kLWNvbG9yOiMzMzM7Ym9yZGVyOjFweCBzb2xpZCAjMzMzO2JvcmRlci1yYWRpdXM6NXB4O3RleHQtYWxpZ246Y2VudGVyO21hcmdpbi1yaWdodDo1cHg7Ym94LXNoYWRvdzppbnNldCAwIDFweCAwICM2NjYsMCAxcHggMCAjYmJiO3BhZGRpbmc6NXB4IDlweDtmb250LXNpemU6MWVtfS5uZ3gtY2hlYXRzaGVldF9faG90a2V5c19fa2V5c19fdGV4dHtwYWRkaW5nLWxlZnQ6MTBweDtmb250LXNpemU6MWVtfS5uZ3gtY2hlYXRzaGVldF9faG90a2V5c19fY2xvc2V7cG9zaXRpb246Zml4ZWQ7dG9wOjIwcHg7cmlnaHQ6MjBweDtmb250LXNpemU6MmVtO2ZvbnQtd2VpZ2h0OjcwMDtwYWRkaW5nOjVweCAxMHB4O2JvcmRlcjoxcHggc29saWQgI2RkZDtib3JkZXItcmFkaXVzOjVweDttaW4taGVpZ2h0OjQ1cHg7bWluLXdpZHRoOjQ1cHg7dGV4dC1hbGlnbjpjZW50ZXJ9QG1lZGlhIGFsbCBhbmQgKG1heC13aWR0aDo1MDBweCl7Lm5neC1jaGVhdHNoZWV0X19ob3RrZXlze2ZvbnQtc2l6ZTouOGVtfX1AbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOjc1MHB4KXsubmd4LWNoZWF0c2hlZXRfX2hvdGtleXN7Zm9udC1zaXplOjEuMmVtfX1gXVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hDaGVhdHNoZWV0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuXG4gIEBJbnB1dCgpXG4gIHRpdGxlOiBzdHJpbmc7XG5cbiAgaGVscFZpc2libGUgPSBmYWxzZTtcbiAgaG90a2V5czogSUhvdGtleVtdO1xuXG4gIHByaXZhdGUgX3N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIHByaXZhdGUgX21hcDogYW55ID0ge1xuICAgIGNvbW1hbmQ6ICdcXHUyMzE4JywgICAgICAgLy8gw6LCjMKYXG4gICAgc2hpZnQ6ICdcXHUyMUU3JywgICAgICAgICAvLyDDosKHwqdcbiAgICBsZWZ0OiAnXFx1MjE5MCcsICAgICAgICAgIC8vIMOiwobCkFxuICAgIHJpZ2h0OiAnXFx1MjE5MicsICAgICAgICAgLy8gw6LChsKSXG4gICAgdXA6ICdcXHUyMTkxJywgICAgICAgICAgICAvLyDDosKGwpFcbiAgICBkb3duOiAnXFx1MjE5MycsICAgICAgICAgIC8vIMOiwobCk1xuICAgICdyZXR1cm4nOiAnXFx1MjNDRScsICAgICAgLy8gw6LCj8KOXG4gICAgYmFja3NwYWNlOiAnXFx1MjMyQicgICAgICAvLyDDosKMwqtcbiAgfTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGhvdGtleXNTZXJ2aWNlOiBOZ3hIb3RrZXlzU2VydmljZSkge1xuICAgIHRoaXMudGl0bGUgPSB0aGlzLmhvdGtleXNTZXJ2aWNlLm9wdGlvbnMuY2hlYXRTaGVldFRpdGxlO1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5fc3Vic2NyaXB0aW9uID0gdGhpcy5ob3RrZXlzU2VydmljZS5jaGVhdFNoZWV0VG9nZ2xlZFxuICAgICAgLnN1YnNjcmliZSgoaXNPcGVuKSA9PiB7XG4gICAgICAgIGlmIChpc09wZW4gIT09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5ob3RrZXlzID0gdGhpcy5ob3RrZXlzU2VydmljZS5ob3RrZXlzXG4gICAgICAgICAgICAuZmlsdGVyKGhvdGtleSA9PiBob3RrZXkuZGVzY3JpcHRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzT3BlbiA9PT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLmhlbHBWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy50b2dnbGVDaGVhdFNoZWV0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgZm9ybWF0SG90a2V5KGhvdGtleTogSUhvdGtleSk6IHN0cmluZ1tdIHtcbiAgICBpZiAoIWhvdGtleS5mb3JtYXQpIHtcbiAgICAgIGNvbnN0IGNvbWJvOiBzdHJpbmcgPSBBcnJheS5pc0FycmF5KGhvdGtleS5jb21ibykgPyBob3RrZXkuY29tYm9bMF0gOiBob3RrZXkuY29tYm87XG4gICAgICBjb25zdCBzZXF1ZW5jZTogc3RyaW5nW10gPSBjb21iby5zcGxpdCgvW1xcc10vKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VxdWVuY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc2VxdWVuY2VbaV0gPSB0aGlzLnN5bWJvbGl6ZShzZXF1ZW5jZVtpXSk7XG4gICAgICB9XG4gICAgICBob3RrZXkuZm9ybWF0ID0gc2VxdWVuY2U7XG4gICAgfVxuICAgIHJldHVybiBob3RrZXkuZm9ybWF0O1xuICB9XG5cbiAgcHJpdmF0ZSBzeW1ib2xpemUoY29tYm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgY29tYm9TcGxpdDogc3RyaW5nW10gPSBjb21iby5zcGxpdCgnKycpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tYm9TcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgLy8gdHJ5IHRvIHJlc29sdmUgY29tbWFuZCAvIGN0cmwgYmFzZWQgb24gT1M6XG4gICAgICBpZiAoY29tYm9TcGxpdFtpXSA9PT0gJ21vZCcpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5uYXZpZ2F0b3IgJiYgd2luZG93Lm5hdmlnYXRvci5wbGF0Zm9ybS5pbmRleE9mKCdNYWMnKSA+PSAwKSB7XG4gICAgICAgICAgY29tYm9TcGxpdFtpXSA9ICdjb21tYW5kJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb21ib1NwbGl0W2ldID0gJ2N0cmwnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb21ib1NwbGl0W2ldID0gdGhpcy5fbWFwW2NvbWJvU3BsaXRbaV1dIHx8IGNvbWJvU3BsaXRbaV07XG4gICAgfVxuICAgIHJldHVybiBjb21ib1NwbGl0LmpvaW4oJyArICcpO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX3N1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHRvZ2dsZUNoZWF0U2hlZXQoKTogdm9pZCB7XG4gICAgdGhpcy5oZWxwVmlzaWJsZSA9ICF0aGlzLmhlbHBWaXNpYmxlO1xuICB9XG59XG4iLCJpbXBvcnQge01vZHVsZVdpdGhQcm92aWRlcnMsIE5nTW9kdWxlfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q29tbW9uTW9kdWxlfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuXG5pbXBvcnQge05neENoZWF0c2hlZXRDb21wb25lbnR9IGZyb20gJy4vbmd4LWNoZWF0c2hlZXQvbmd4LWNoZWF0c2hlZXQuY29tcG9uZW50JztcbmltcG9ydCB7Tmd4SG90a2V5c0RpcmVjdGl2ZX0gZnJvbSAnLi9uZ3gtaG90a2V5cy5kaXJlY3RpdmUnO1xuaW1wb3J0IHtOZ3hIb3RrZXlzU2VydmljZX0gZnJvbSAnLi9uZ3gtaG90a2V5cy5zZXJ2aWNlJztcbmltcG9ydCB7SG90a2V5T3B0aW9uc30gZnJvbSAnLi90b2tlbic7XG5pbXBvcnQge0lIb3RrZXlPcHRpb25zfSBmcm9tICcuL2ludGVyZmFjZXMnO1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlXSxcbiAgZGVjbGFyYXRpb25zOiBbTmd4Q2hlYXRzaGVldENvbXBvbmVudCwgTmd4SG90a2V5c0RpcmVjdGl2ZV0sXG4gIGV4cG9ydHM6IFtOZ3hIb3RrZXlzRGlyZWN0aXZlLCBOZ3hDaGVhdHNoZWV0Q29tcG9uZW50XSxcbiAgcHJvdmlkZXJzOiBbTmd4SG90a2V5c1NlcnZpY2VdXG59KVxuZXhwb3J0IGNsYXNzIE5neEhvdGtleXNNb2R1bGUge1xuICBzdGF0aWMgZm9yUm9vdChvcHRpb25zPzogSUhvdGtleU9wdGlvbnMpOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IE5neEhvdGtleXNNb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgTmd4SG90a2V5c1NlcnZpY2UsXG4gICAgICAgIHtwcm92aWRlOiBIb3RrZXlPcHRpb25zLCB1c2VWYWx1ZTogb3B0aW9uc31cbiAgICAgIF1cbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsiSW5qZWN0aW9uVG9rZW4iLCJTdWJqZWN0Iiwic2hhcmUiLCJJbmplY3RhYmxlIiwiSW5qZWN0IiwidHNsaWJfMS5fX3ZhbHVlcyIsIkRpcmVjdGl2ZSIsIkVsZW1lbnRSZWYiLCJJbnB1dCIsIkNvbXBvbmVudCIsIk5nTW9kdWxlIiwiQ29tbW9uTW9kdWxlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEseUJBSWEsYUFBYSxHQUFHLElBQUlBLG1CQUFjLENBQWlCLGVBQWUsQ0FBQzs7Ozs7O0FDSmhGLElBU0EscUJBQU0sZUFBZSxHQUFtQjtRQUN0QyxpQkFBaUIsRUFBRSxLQUFLO1FBQ3hCLGVBQWUsRUFBRSxxQkFBcUI7UUFDdEMsZ0JBQWdCLEVBQUUsR0FBRztRQUNyQiwyQkFBMkIsRUFBRSw0QkFBNEI7UUFDekQsa0JBQWtCLEVBQUUsS0FBSztRQUN6Qiw2QkFBNkIsRUFBRSxxQkFBcUI7S0FDckQsQ0FBQzs7UUFZQSwyQkFBMkM7WUFBQSxhQUFRLEdBQVIsUUFBUTtzQ0FOUixJQUFJLEdBQUcsRUFBRTtrQ0FDYixJQUFJLEdBQUcsRUFBRTtzQ0FFTCxJQUFJQyxZQUFPLEVBQUU7OEJBQ25DLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxVQUFVLENBQUM7WUFH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